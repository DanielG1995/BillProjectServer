"use strict";(self.webpackChunkfactura_proyecto=self.webpackChunkfactura_proyecto||[]).push([[956],{9956:function(e,n,l){l.r(n),l.d(n,{default:function(){return $}});var t=l(5861),i=l(2982),a=l(885),r=l(7757),o=l.n(r),s=l(2791),c=l(4942),d=l(8182),u=l(8596),m=l(3108),h=l(6556),v=l(6593),f=l(7631),p=l(2206),g=l(9773),b=l(2634),x=l(3486),Z=l(3928),j=l(7690),_=l(8302),S=l(9526),k=l(7025),N=l(3509),w=l(7407),C=l(184);function P(e,n,l){return n[l]<e[l]?-1:n[l]>e[l]?1:0}function I(e,n){return"desc"===e?function(e,l){return P(e,l,n)}:function(e,l){return-P(e,l,n)}}function y(e,n){var l=e.map((function(e,n){return[e,n]}));return l.sort((function(e,l){var t=n(e[0],l[0]);return 0!==t?t:e[1]-l[1]})),l.map((function(e){return e[0]}))}function E(e){var n=e.classes,l=e.order,t=e.orderBy,i=e.onRequestSort,a=e.headCells;return(0,C.jsx)(g.Z,{children:(0,C.jsx)(x.Z,{children:a.map((function(e){return(0,C.jsx)(f.Z,{align:"center",padding:e.disablePadding?"none":"normal",sortDirection:t===e.id&&l,children:(0,C.jsxs)(Z.Z,{active:t===e.id,direction:t===e.id?l:"asc",onClick:(a=e.id,function(e){i(e,a)}),className:"text-dark",children:[e.label,t===e.id?(0,C.jsx)("span",{className:n.visuallyHidden,children:"desc"===l?"sorted descending":"sorted ascending"}):null]})},e.id);var a}))})})}var T=(0,u.Z)((function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:(0,m.$n)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{flex:"1 1 100%"}}})),U=function(e){var n=T(),l=e.numSelected,t=e.title;return(0,C.jsxs)(j.Z,{className:(0,d.Z)(n.root,(0,c.Z)({},n.highlight,l>0)),children:[l>0?(0,C.jsxs)(_.Z,{className:n.title,color:"inherit",variant:"subtitle1",component:"div",children:[l," selected"]}):(0,C.jsx)(_.Z,{className:n.title,variant:"h6",id:"tableTitle",component:"div",children:t}),l>0&&(0,C.jsx)(N.ZP,{title:"Delete",children:(0,C.jsx)(k.Z,{"aria-label":"delete",children:(0,C.jsx)(w.Z,{})})})]})},O=(0,u.Z)((function(e){return{root:{width:"auto",height:"auto"},paper:{width:"auto",height:"auto",marginBottom:e.spacing(2),backgroundColor:"gray",color:"black"},table:{minWidth:500},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"relative",top:20,width:1}}})),R=function(e){var n=O(),l=e.onSelectRow,t=s.useState("asc"),i=(0,a.Z)(t,2),r=i[0],o=i[1],c=s.useState("calories"),d=(0,a.Z)(c,2),u=d[0],m=d[1],g=s.useState([]),Z=(0,a.Z)(g,2),j=Z[0],_=Z[1],k=s.useState(0),N=(0,a.Z)(k,2),w=N[0],P=N[1],T=s.useState(!0),R=(0,a.Z)(T,1)[0],M=s.useState(5),A=(0,a.Z)(M,2),z=A[0],D=A[1],L=e.title,B=e.columns,Y=e.rows,F=z-Math.min(z,Y.length-w*z);return(0,C.jsx)("div",{className:n.root,children:(0,C.jsxs)(S.Z,{className:"".concat(n.paper," h-100vh"),children:[(0,C.jsx)(U,{numSelected:j.length,title:L}),(0,C.jsx)(p.Z,{children:(0,C.jsxs)(h.Z,{className:n.table,"aria-labelledby":"tableTitle",size:R?"small":"medium","aria-label":"enhanced table",children:[(0,C.jsx)(E,{classes:n,numSelected:j.length,order:r,orderBy:u,onSelectAllClick:function(e){if(e.target.checked){var n=Y.map((function(e){return e.id}));_(n)}else _([])},onRequestSort:function(e,n){o(u===n&&"asc"===r?"desc":"asc"),m(n)},rowCount:Y.length,headCells:B}),(0,C.jsxs)(v.Z,{children:[y(Y,I(r,u)).slice(w*z,w*z+z).map((function(e,n){var t,i=(t=e.id,-1!==j.indexOf(t)),a="enhanced-table-checkbox-".concat(n);return(0,C.jsxs)(x.Z,{hover:!0,role:"checkbox","aria-checked":i,tabIndex:-1,selected:i,className:"text-white",children:[(0,C.jsx)(f.Z,{component:"th",id:a,scope:"row",children:e.fecha}),(0,C.jsx)(f.Z,{align:"right",children:e.totalSinImpuesto}),(0,C.jsx)(f.Z,{align:"right",children:e.total}),(0,C.jsx)(f.Z,{align:"right",children:e.productos}),(0,C.jsx)(f.Z,{align:"right",children:e.sucursal.num}),(0,C.jsx)(f.Z,{align:"center",children:e.establecimiento.razonSocial}),(0,C.jsx)(f.Z,{style:{cursor:"pointer"},onClick:function(){l(e)},children:"Ver..."})]},e.id)})),F>0&&(0,C.jsx)(x.Z,{style:{height:(R?33:53)*F},children:(0,C.jsx)(f.Z,{colSpan:6})})]})]})}),(0,C.jsx)(b.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:Y.length,rowsPerPage:z,page:w,onPageChange:function(e,n){P(n)},onRowsPerPageChange:function(e){D(parseInt(e.target.value,10)),P(0)}})]})})},M=l(1899),A=l(6045),z=l(1),D=l(6168),L=l(3896),B=l(5471),Y=l(887),F=l(2426),H=l.n(F),q=function(e){return e.map((function(e,n){var l,t,i,a,r;return{idMongo:null===e||void 0===e?void 0:e.id,id:n,fecha:H()(null===e||void 0===e?void 0:e.fechaEmision).format("DD-MM-YYYY"),totalSinImpuesto:null===e||void 0===e?void 0:e.totalSinImpuesto,total:null===e||void 0===e?void 0:e.importeTotal,productos:null===e||void 0===e||null===(l=e.detalles)||void 0===l?void 0:l.length,sucursal:{num:null===e||void 0===e||null===(t=e.sucursal)||void 0===t?void 0:t.numEstab,id:null===e||void 0===e||null===(i=e.sucursal)||void 0===i?void 0:i._id},establecimiento:{razonSocial:null===e||void 0===e||null===(a=e.establecimiento)||void 0===a?void 0:a.razonSocial,id:null===e||void 0===e||null===(r=e.establecimiento)||void 0===r?void 0:r._id},detalles:null===e||void 0===e?void 0:e.detalles}}))},V=function(e){var n=[];return e.forEach((function(e){var l;null===(l=e.detalles)||void 0===l||l.forEach((function(e){n.some((function(n){return(null===e||void 0===e?void 0:e.codigoPrincipal)===(null===n||void 0===n?void 0:n.value)||(null===e||void 0===e?void 0:e.descripcion)===(null===n||void 0===n?void 0:n.label)}))||n.push({label:null===e||void 0===e?void 0:e.descripcion,value:null===e||void 0===e?void 0:e.codigoPrincipal})}))})),n.sort((function(e,n){return e.label>n.label}))},W=[{id:"fecha",numeric:!1,label:"FECHA",disablePadding:!0},{id:"totalSinImpuesto",numeric:!0,label:"TOTAL SIN IMPUESTO",disablePadding:!0},{id:"total",numeric:!0,label:"TOTAL",disablePadding:!0},{id:"productos",numeric:!0,label:"# PRODUCTOS",disablePadding:!0},{id:"sucursal",numeric:!0,label:"SUCURSAL",disablePadding:!0},{id:"establecimiento",numeric:!1,label:"ESTABLECIMIENTO",disablePadding:!0}],$=function(){var e=(0,M.I0)(),n=(0,M.v9)((function(e){return e.factura})).facturas,l=(0,s.useState)([]),r=(0,a.Z)(l,2),c=r[0],d=r[1],u=(0,s.useState)([]),m=(0,a.Z)(u,2),h=m[0],v=m[1],f=(0,s.useState)([]),p=(0,a.Z)(f,2),g=p[0],b=p[1],x=(0,s.useState)("all"),Z=(0,a.Z)(x,2),j=Z[0],_=Z[1],S=(0,s.useState)("all"),k=(0,a.Z)(S,2),N=k[0],w=k[1],P=(0,s.useState)([]),I=(0,a.Z)(P,2),y=I[0],E=I[1],T=(0,s.useState)([]),U=(0,a.Z)(T,2),O=U[0],F=U[1],H=(0,s.useState)([]),$=(0,a.Z)(H,2),G=$[0],J=$[1],K=(0,s.useState)("all"),Q=(0,a.Z)(K,2),X=Q[0],ee=Q[1],ne=(0,s.useState)([]),le=(0,a.Z)(ne,2),te=le[0],ie=le[1],ae=function(e){if(_(e),"all"===e)return F((0,i.Z)(y)),v((0,i.Z)(c));v(c.filter((function(n){return n.establecimiento.id===e}))),F(y.filter((function(n){var l;return(null===n||void 0===n||null===(l=n.establecimiento)||void 0===l?void 0:l._id)===e}))),w("all")},re=function(e){if(w(e),"all"===e&&"all"===j&&"all"===X)return v((0,i.Z)(c));var n=c.filter((function(n){return"all"===e?n.establecimiento.id===j:n.sucursal.id===e}));n.length>0&&_(n[0].establecimiento.id),v((0,i.Z)(n))};(0,s.useEffect)((function(){ie("all"!==j||"all"!==N?V(h):G)}),[j,N,h,G]);var oe=(0,s.useCallback)((0,t.Z)(o().mark((function e(){var n,l,t,i,r,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,z.g2)("facturas/estab"),l=(0,z.g2)("facturas/sucursales"),e.next=5,Promise.all([n,l]);case 5:if(t=e.sent,i=(0,a.Z)(t,2),r=i[0],s=i[1],r.data.ok){e.next=11;break}return e.abrupt("return",(0,A.N)("login",r.msg,"error"));case 11:if(b(r.data.content.establecimientos),s.data.ok){e.next=14;break}return e.abrupt("return",(0,A.N)("login",s.msg,"error"));case 14:E(s.data.content.sucursales),F(s.data.content.sucursales),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),(0,A.N)("login",e.t0,"error");case 21:case"end":return e.stop()}}),e,null,[[0,18]])}))),[]);(0,s.useEffect)((function(){oe()}),[oe,n]),(0,s.useEffect)((function(){v(q(n)),d(q(n)),J(V(n)),ie(V(n))}),[n]);return(0,C.jsx)("div",{className:"container text-white mt-5",children:(0,C.jsxs)("div",{className:"row align-items-start",children:[(0,C.jsx)("div",{className:"col-12 animate__animated animate__bounce animate__fadeInUp animate__fast",children:(0,C.jsx)("h2",{children:"Filtros"})}),(0,C.jsx)("div",{className:"col-3",children:(0,C.jsxs)("div",{className:"row p-3 animate__animated animate__bounce animate__fadeInUp animate__fast",children:[(0,C.jsx)(D.Z,{id:"demo-simple-select-label",children:"Establecimientos"}),(0,C.jsxs)(L.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:j,onChange:function(e){return ae(e.target.value)},children:[(0,C.jsx)(B.Z,{value:"all",children:"Todos"}),g.map((function(e,n){return(0,C.jsx)(B.Z,{value:e.id,children:e.razonSocial},n)}))]})]})}),(0,C.jsx)("div",{className:"col-3 animate__animated animate__bounce animate__fadeInUp animate__fast",children:(0,C.jsxs)("div",{className:"row p-3",children:[(0,C.jsx)(D.Z,{id:"demo-simple-select-label",children:"Sucursales"}),(0,C.jsxs)(L.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:N,onChange:function(e){return re(e.target.value)},children:[(0,C.jsx)(B.Z,{value:"all",children:"Todos"}),O.map((function(e,n){return(0,C.jsxs)(B.Z,{value:e.id,children:[e.numEstab,"| ",e.direccion]},n)}))]})]})}),(0,C.jsx)("div",{className:"col-3 animate__animated animate__bounce animate__fadeInUp animate__fast",children:(0,C.jsxs)("div",{className:"row p-3",children:[(0,C.jsx)(D.Z,{id:"demo-simple-select-label",children:"Productos"}),(0,C.jsxs)(L.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:X,onChange:function(e){return function(e){if(ee(e),"all"===N)if("all"===j)if("all"===e)v((0,i.Z)(c));else{var n=c.filter((function(n){var l,t;return(null===n||void 0===n||null===(l=n.detalles)||void 0===l||null===(t=l.filter((function(n){return(null===n||void 0===n?void 0:n.descripcion)===e})))||void 0===t?void 0:t.length)>0}));v((0,i.Z)(n))}else ae(j);else re(N)}(e.target.value)},children:[(0,C.jsx)(B.Z,{value:"all",children:"Todos"}),null===te||void 0===te?void 0:te.map((function(e,n){return(0,C.jsx)(B.Z,{value:e.label,title:e.label,children:e.label.slice(0,30)},n+"prods")}))]})]})}),(0,C.jsx)("div",{className:"col-12 mt-3 animate__animated animate__bounce animate__fadeInUp animate__fast",children:(0,C.jsx)(R,{title:"Facturas",columns:W,rows:h,onSelectRow:function(l){var t=n.find((function(e){return l.idMongo===e.id}));console.log(t),e((0,Y.E3)(t))}})})]})})}}}]);
//# sourceMappingURL=956.002b6fa8.chunk.js.map