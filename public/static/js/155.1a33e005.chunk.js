"use strict";(self.webpackChunkfactura_proyecto=self.webpackChunkfactura_proyecto||[]).push([[155],{1155:function(i,e,o){o.r(e);var t=o(2982),n=o(5861),l=o(885),c=o(7757),r=o.n(c),a=o(2791),d=o(1),s=o(9719),u=o(2426),v=o.n(u),p=o(928),x=o(184);e.default=function(){var i=(0,a.useState)([]),e=(0,l.Z)(i,2),o=e[0],c=e[1],u=(0,a.useState)([]),f=(0,l.Z)(u,2),h=f[0],m=f[1],g=(0,a.useState)(0),b=(0,l.Z)(g,2),j=b[0],w=b[1],M=(0,a.useState)(!1),k=(0,l.Z)(M,2),N=k[0],P=k[1],S=(0,a.useState)(!1),Y=(0,l.Z)(S,2),y=Y[0],C=Y[1],D=(0,a.useState)({}),R=(0,l.Z)(D,2),Z=R[0],U=R[1],O=function(){var i=(0,n.Z)(r().mark((function i(){var e,o=arguments;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e=o.length>0&&void 0!==o[0]?o[0]:0,Math.ceil(10*(j+e))<=h.length&&w((function(i){return Math.max(0,i+e)}));case 2:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}(),z=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"descripcion",e=(0,t.Z)(h);m(e.sort((function(e,o){return(null===o||void 0===o?void 0:o[i])-(null===e||void 0===e?void 0:e[i])}))),c((0,t.Z)(e.slice(10*j,10*j+10)))},E=(0,a.useCallback)((0,n.Z)(r().mark((function i(){var e,o,t,n,l;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,null===(e=JSON.parse(localStorage.getItem("datosProds")?localStorage.getItem("datosProds"):""))||void 0===e||!e.lastUpdate||!v()(new Date).isBefore(v()(null===e||void 0===e?void 0:e.lastUpdate).add(10,"m"),"m")){i.next=6;break}return m(null===e||void 0===e?void 0:e.data),c(null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.slice(0,10)),i.abrupt("return");case 6:i.next=10;break;case 8:i.prev=8,i.t0=i.catch(0);case 10:return P(!0),i.prev=11,i.next=14,(0,d.g2)("productos/precios");case 14:null!==(n=i.sent)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.ok&&(l=[],n.data.precios.forEach((function(i){if(null!==l&&void 0!==l&&l[null===i||void 0===i?void 0:i.codigoPrincipal]){var e,o,t,n,c;if(l[null===i||void 0===i?void 0:i.codigoPrincipal].total=l[null===i||void 0===i?void 0:i.codigoPrincipal].total+1,(null===l||void 0===l||null===(e=l[null===i||void 0===i?void 0:i.codigoPrincipal])||void 0===e?void 0:e.precioMin)>(null===i||void 0===i?void 0:i.precioUnitario)||(null===l||void 0===l||null===(o=l[null===i||void 0===i?void 0:i.codigoPrincipal])||void 0===o?void 0:o.precioMax)<(null===i||void 0===i?void 0:i.precioUnitario))l[null===i||void 0===i?void 0:i.codigoPrincipal].precioMin=null===i||void 0===i?void 0:i.precioUnitario,l[null===i||void 0===i?void 0:i.codigoPrincipal].fechaRegistroMax=v()(null===i||void 0===i?void 0:i.fechaRegistro).format("DD-MM-YYYY"),l[null===i||void 0===i?void 0:i.codigoPrincipal].establecimiento=null===i||void 0===i||null===(n=i.establecimiento)||void 0===n?void 0:n.razonSocial;if((null===l||void 0===l||null===(t=l[null===i||void 0===i?void 0:i.codigoPrincipal])||void 0===t?void 0:t.precioMax)<(null===i||void 0===i?void 0:i.precioUnitario))l[null===i||void 0===i?void 0:i.codigoPrincipal].precioMax=null===i||void 0===i?void 0:i.precioUnitario,l[null===i||void 0===i?void 0:i.codigoPrincipal].fechaRegistroMin=v()(null===i||void 0===i?void 0:i.fechaRegistro).format("DD-MM-YYYY"),l[null===i||void 0===i?void 0:i.codigoPrincipal].establecimiento=null===i||void 0===i||null===(c=i.establecimiento)||void 0===c?void 0:c.razonSocial}else{var r,a;l[null===i||void 0===i?void 0:i.codigoPrincipal]={codigo:null===i||void 0===i?void 0:i.codigoPrincipal,descripcion:null===i||void 0===i||null===(r=i.producto)||void 0===r?void 0:r.descripcion,precioMin:null===i||void 0===i?void 0:i.precioUnitario,precioMax:null===i||void 0===i?void 0:i.precioUnitario,fechaRegistroMax:v()(null===i||void 0===i?void 0:i.fechaRegistro).format("DD-MM-YYYY"),fechaRegistroMin:v()(null===i||void 0===i?void 0:i.fechaRegistro).format("DD-MM-YYYY"),establecimiento:null===i||void 0===i||null===(a=i.establecimiento)||void 0===a?void 0:a.razonSocial,total:1}}})),localStorage.setItem("datosProds",JSON.stringify({data:Object.values(l),lastUpdate:new Date})),m(Object.values(l)),c(Object.values(l).slice(0,10))),i.next=20;break;case 18:i.prev=18,i.t1=i.catch(11);case 20:P(!1);case 21:case"end":return i.stop()}}),i,null,[[0,8],[11,18]])}))),[]);(0,a.useEffect)((function(){E()}),[E]),(0,a.useEffect)((function(){c((0,t.Z)(h.slice(10*j,10*j+10)))}),[j,h]);var F=function(){var i=(0,n.Z)(r().mark((function i(e){var o,t,n,l;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,(0,d.g2)("productos/".concat(null===e||void 0===e?void 0:e.codigo));case 3:null!==(t=i.sent)&&void 0!==t&&null!==(o=t.data)&&void 0!==o&&o.ok&&(U({producto:e,precios:null===t||void 0===t||null===(n=t.data)||void 0===n||null===(l=n.precios)||void 0===l?void 0:l.sort((function(i,e){return new Date(null===i||void 0===i?void 0:i.fechaRegistro).getTime()-new Date(null===e||void 0===e?void 0:e.fechaRegistro).getTime()}))}),C(!0)),i.next=9;break;case 7:i.prev=7,i.t0=i.catch(0);case 9:case"end":return i.stop()}}),i,null,[[0,7]])})));return function(e){return i.apply(this,arguments)}}();return(0,x.jsxs)("div",{className:"container mt-5 ",children:[(0,x.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,x.jsx)("h2",{className:"d-inline",children:"Productos"}),(0,x.jsx)("button",{onClick:function(){localStorage.removeItem("datosProds"),E()},children:"Actualizar"})]}),(0,x.jsx)("hr",{}),N?(0,x.jsx)("div",{className:"row d-flex justify-content-center",children:(0,x.jsx)(s.z,{})}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"row d-flex justify-content-end mx-5 my-2",children:[10*j," - ",10*j+10," de ",h.length]}),(0,x.jsxs)("div",{className:"col-12 d-flex justify-content-center flex-wrap h-75 table-min",children:[(0,x.jsx)("div",{onClick:function(){return z("descripcion")},className:"col-3 text-white px-2 border",children:"Descripci\xf3n"}),(0,x.jsx)("div",{onClick:function(){return z("precioMin")},className:"col-1 text-white px-2 border",children:"Precio m\xednimo"}),(0,x.jsx)("div",{onClick:function(){return z("precioMax")},className:"col-1 text-white px-2 border",children:"Precio m\xe1ximo"}),(0,x.jsx)("div",{onClick:function(){return z("fechaRegistro")},className:"col-3 text-white px-2 border",children:"Fecha registro max/min"}),(0,x.jsx)("div",{onClick:function(){return z("total")},className:"col-1  text-white px-2 border",children:"Total registrados"}),(0,x.jsx)("div",{onClick:function(){return z("establecimiento")},className:"col-3 text-white px-2 border",children:"Establecimiento"}),o.map((function(i){var e,o;return(0,x.jsxs)("div",{className:"col-12 p-0 m-0 prod-class d-flex flex-wrap align-items-center border-start border-end pointer",onClick:function(){return F(i)},children:[(0,x.jsx)("div",{title:i.descripcion,className:"col-3  text-white px-2 ",children:i.descripcion.length>30?i.descripcion.slice(0,26)+"...":i.descripcion}),(0,x.jsxs)("div",{className:"col-1  text-white px-2",children:["$ ",null===(e=i.precioMin)||void 0===e?void 0:e.toFixed(2)]}),(0,x.jsxs)("div",{className:"col-1  text-white px-2",children:["$ ",null===(o=i.precioMax)||void 0===o?void 0:o.toFixed(2)]}),(0,x.jsxs)("div",{className:"col-3  text-white px-2",children:[i.fechaRegistroMax," ","/"," ",i.fechaRegistroMin]}),(0,x.jsxs)("div",{className:"col-1  text-white px-2",children:[" ",i.total]}),(0,x.jsx)("div",{title:i.establecimiento,className:"col-3  text-white px-2 ",children:i.establecimiento.length>30?i.establecimiento.slice(0,26)+"...":i.establecimiento})]},i.codigo)})),(0,x.jsxs)("div",{className:"col-12 d-flex justify-content-center border-top pt-5",children:[(0,x.jsx)("button",{className:"btn btn-primary mx-5",onClick:function(){return O(-1)},children:"Atr\xe1s"}),(0,x.jsx)("button",{className:"btn btn-primary mx-5",onClick:function(){return O(1)},children:"Siguiente"})]})]})]}),(0,x.jsx)(p.o,{openModal:y,setOpenModal:C,producto:Z})]})}}}]);
//# sourceMappingURL=155.1a33e005.chunk.js.map